from excel_magic.dataset import open_file,Style
from excel_magic.diff import diff

restore_excel_file = open_file("库存信息子表.xlsx")
total_excel_file = open_file("库存信息总表.xlsx")
check_excel_file =open_file("库存信息子表.xlsx").duplicate("check_excel_file.xlsx")
diff_result = diff(restore_excel_file.get_sheet_by_index(0),total_excel_file.get_sheet_by_index(0))

restore_excel_file.sheets.append(diff_result.not_found_in_b)
rows = diff_result.not_found_in_b.get_rows()

style =Style(fill_color="#FFC7CD",font_color="#C65F60")
check_excel_file.get_sheet_by_index(0).highlight(rows,style)
check_excel_file.save()
